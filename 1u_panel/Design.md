# OreSat Solar Module v2## Everything is Terrible (architecture)The system architecture of OreSat is weird, and possibly seriously dumb. However, it has a lot of advantages that, despite it's dumbness, are a system-win. One of those dumb ideas that might be either a terrible, terrible mistake or a brilliant stroke of insight (emphasis, possibly, on the stroke) is that the Vbus is based on the Vbat which are two series Lipo cells. Meaning, the Vbus ranges from 6.0 to 8.4 V. Yep. We told you. Brilliant or dumbass. Ask us in 2020 and we'll let you know.Based on that, we wanted a maximum power point tracer (MPPT) that could take our solar array input and buck/boost that to the 8.4V necessary to charge the battery. Thus there's only one SPS between the array and the batteries, and it's MPPT. A true MPPT, mind you, not one of these namby pamby "70% Voc" maximum power point "controllers".Finally, we were very interested in a modular array that could stand on it's own, even on a 1U, so we decided to make a single module that stood on its own and could be paralleled with other modules.## Solar arrayThe array will be two 27 cm^2 GaAS XTE-SF triple junction solar cells from Spectrolabs, wired together in series. From their datasheet:    Voc =  Ncells * Voc * = 2 * 2.75V = 5.5V    Vmp = Ncells * Vmp = 5 * 2.435V = 4.87V    Isc = 502 mA     256 mA with no cover, but we're assuming a cover    Imp  = 480.6 mA    Pmax/mp = Vmp * Imp = 4.87 * .481 = 2.3376 W## MPPT ICsRequirements:- (4.0, 4.87, 5.5) V input from the Alta Devices array.- 6.0 - 8.4 V output connected directly to our LiPo cells -- we don't want a separate battery charger.- MPPT, not MPPC.Since there are no COTS ICs that do this, we are unwisely implementing our own MPPT controlled by the onboard uC and the **LT1618** SPS.  The LT1618 is a boost supply with both a CC/CV modes.  The package features a current adjust pin that reads an analog voltage and adjusts the output to a corresponding current, the pin can be grounded for a CV mode.  Our P/V/I sensors will talk I2C to our uC which will calculate our MPPT, and send an analog voltage to the current adjust pin via an I2C DAC.  This design doubles as our battery charging regulator for the LiPo batteries as well as our MPPT.  For configuration and parts, see the [LT1618 design notes](LT1618.md).## Sensor ICsWe choose the TI **INA226** to measure voltage, and current from the solar array.  Current is measured across the same shunt resistor that the LT1618 uses and talks I2C to our uC.   See the [INA226 design notes](INA226.md).We chose the TI **TMP100** as our temperature sensor.  It comes in an adorable SOT-23 package so we can flip that package upside down and fit the chip into a slot cut into the board so that we can get a more accurate temperature reading of the solar array.  Also has the benefit of working of a wide temperature range and talking I2C to our uC.**Note: Since the temperature sensor is flipped upside down and fits into a slot in the board, the pins will be flipped from the pinout on the datasheet**## MicrocontrollerFor many reasons, we're using the ST **STM32F09x**, which is a 48 LQFP pin Cortex M0 IC which talks CAN. We're using it all over the place on OreSat. And we choose the TI **TCAN330** as the CAN transceiver.## 3.3 V SPSAfter looking at a billion 3.3V switcher ICs, we really like the TI **TPS63070**. The final system footprint is large, but it does buck-boost so that we can get 3.3V even if our batteries are down to their 3.0V minimum voltage. Also, temporary brownouts should be OK given the boost and the giant capacitor banks the TPS63070 requires. See the [TPS63070 design notes](TPS63070.md)## OreSat ShutdownThe Remove Before Flight (RBF) and rail inhibit switches all need to shut down OreSat. We have an "open collector" shutdown system; pulling the line to ground shuts down OreSat. The STM can decide to shut down it's local panel, too.We choose regular 1N4448 diodes for the shutdown path because of the horrific leakage current of Schottkey diodes at high temperatures. They leavek **10s of mA!!11!!**. That's a lot. So we choose a silicon diode, run at very low current, so the most the Vf will be is 0.7 V even at very low temperatures.